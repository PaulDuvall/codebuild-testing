version: 0.2
phases:
  install:
    runtime-versions:
      nodejs: 12
    commands:
      - node --version
  build:
    commands:
      - npm install
      - npm install aws-cli-js
      - ACCOUNT_ID=$(aws sts get-caller-identity --output text --query 'Account')
      - echo $ACCOUNT_ID
      # - aws s3 mb s3://ceoa-tbd-$ACCOUNT_ID
      # - >-
      #   aws s3 mb s3://pmd-codebuild-$ACCOUNT_ID
      - >-
        cd webapp
      - >-
        zip pmd-pipeline-071420.zip *.*
      - >-
        aws s3 sync . s3://$PIPELINE_BUCKET
artifacts:
  files:
    - '**/*'
